<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div>

    </div>
    <script>
        //全局的event对象，提供on,off,emit方法，
        var event = (function () {
            eventObjs = {}
            return {
                /* *
                注册时间，可以连续注册，可以注册多个事件ss
                * */
                on: function (type, handler) {
                    (eventObjs[type] || (eventObjs[type] = [])).push(handler)
                },
                off: function (type, handler) {
                    if (arguments.length === 0) {//没有参数，移除所有，
                        eventObjs = {}
                    } else if (arguments.length === 1) {//只有事件额类型，移除该事件的所有处理函数
                        eventObjs[type] = []
                    } else if (arguments.length === 2) {//移除type事件的handler处理函数
                        //使用循环移除所有该函数对应的type事件
                        let _events = eventObjs[type]
                        if (!_events) { return }
                        /* 倒着循环 数组的序号不会受到影响 */
                        for (let i = _event.length - 1; i >= 0; i--) {
                            if (_events[i] === handler) {
                                _events.splice(i, 1)
                            }
                        }
                    }
                },
                /* *
                发射事件，触发事件，包装参数，传递给事件处理函数
                * */
                emit: function (type) {
                    let args = Array.prototype.slice.call(arguments, 1)
                    let _event = eventObjs[type]
                    if (!_event) return
                    for (let i = 0; i < _event.length; i++) {
                        //如果绑定上下文就需要使用call和apply
                        _event[i].apply(null, args)
                    }
                }
            }
        })()
    </script>
    <script>
        event.on("click", () => { console.log(1) })
        event.on("click", () => { console.log(2) })
        event.on("click", () => { console.log(3) })
        event.on("click", () => { console.log(4) })
        function f() {
            event.emit('click')
        }
        f()
    </script>
</body>

</html>